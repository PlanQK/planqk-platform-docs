<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Create and Test an On-premise Service | PlanQK Docs</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/material-symbols/outlined.css">
    <link rel="stylesheet" href="/material-symbols/customization.css">
    <link rel="stylesheet" href="/fontawesome/css/all.css">
    <script defer="defer" data-domain="docs.platform.planqk.de" src="https://plausible.anaqor.io/js/script.outbound-links.file-downloads.tagged-events.js"></script>
    <meta name="description" content="PlanQK Docs - Platform and Ecosystem for Quantum Applications">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.637df5cf.css" as="style"><link rel="preload" href="/assets/js/app.05958cb9.js" as="script"><link rel="preload" href="/assets/js/2.acda9268.js" as="script"><link rel="preload" href="/assets/js/1.cf86e968.js" as="script"><link rel="preload" href="/assets/js/77.a9350b63.js" as="script"><link rel="prefetch" href="/assets/js/10.ce49439f.js"><link rel="prefetch" href="/assets/js/11.e8d19a4b.js"><link rel="prefetch" href="/assets/js/12.4198bb3e.js"><link rel="prefetch" href="/assets/js/13.0a27fdb0.js"><link rel="prefetch" href="/assets/js/14.dd66ed3e.js"><link rel="prefetch" href="/assets/js/15.5edd316a.js"><link rel="prefetch" href="/assets/js/16.faff0015.js"><link rel="prefetch" href="/assets/js/17.59a27870.js"><link rel="prefetch" href="/assets/js/18.f6493fcc.js"><link rel="prefetch" href="/assets/js/19.fdfe9baa.js"><link rel="prefetch" href="/assets/js/20.545f3679.js"><link rel="prefetch" href="/assets/js/21.9166dba7.js"><link rel="prefetch" href="/assets/js/22.e3da8f0b.js"><link rel="prefetch" href="/assets/js/23.b9dfda29.js"><link rel="prefetch" href="/assets/js/24.03fdae1b.js"><link rel="prefetch" href="/assets/js/25.a55846fa.js"><link rel="prefetch" href="/assets/js/26.226f71b8.js"><link rel="prefetch" href="/assets/js/27.bb6a2c25.js"><link rel="prefetch" href="/assets/js/28.d55ee4c9.js"><link rel="prefetch" href="/assets/js/29.f78f3526.js"><link rel="prefetch" href="/assets/js/3.746032a3.js"><link rel="prefetch" href="/assets/js/30.97def951.js"><link rel="prefetch" href="/assets/js/31.b816dc12.js"><link rel="prefetch" href="/assets/js/32.2f23c728.js"><link rel="prefetch" href="/assets/js/33.e5a8d9c0.js"><link rel="prefetch" href="/assets/js/34.c52d849b.js"><link rel="prefetch" href="/assets/js/35.9cc31a0d.js"><link rel="prefetch" href="/assets/js/36.1f2590b7.js"><link rel="prefetch" href="/assets/js/37.96bf9d5f.js"><link rel="prefetch" href="/assets/js/38.7f7a759b.js"><link rel="prefetch" href="/assets/js/39.19e86271.js"><link rel="prefetch" href="/assets/js/4.2b03963c.js"><link rel="prefetch" href="/assets/js/40.eac5173b.js"><link rel="prefetch" href="/assets/js/41.cb8db225.js"><link rel="prefetch" href="/assets/js/42.fb440fee.js"><link rel="prefetch" href="/assets/js/43.57b65087.js"><link rel="prefetch" href="/assets/js/44.89ed1dcc.js"><link rel="prefetch" href="/assets/js/45.d704ce4f.js"><link rel="prefetch" href="/assets/js/46.6fd42564.js"><link rel="prefetch" href="/assets/js/47.6244d42f.js"><link rel="prefetch" href="/assets/js/48.e409e0d8.js"><link rel="prefetch" href="/assets/js/49.228d5b09.js"><link rel="prefetch" href="/assets/js/5.e52cc9a6.js"><link rel="prefetch" href="/assets/js/50.cff1ba6e.js"><link rel="prefetch" href="/assets/js/51.84a7c46e.js"><link rel="prefetch" href="/assets/js/52.5f7ef8ba.js"><link rel="prefetch" href="/assets/js/53.0947e9e3.js"><link rel="prefetch" href="/assets/js/54.1f44e56b.js"><link rel="prefetch" href="/assets/js/55.f1a7e698.js"><link rel="prefetch" href="/assets/js/56.c4dcecf5.js"><link rel="prefetch" href="/assets/js/57.1de25ba9.js"><link rel="prefetch" href="/assets/js/58.fd3df8da.js"><link rel="prefetch" href="/assets/js/59.c5fadc31.js"><link rel="prefetch" href="/assets/js/6.34ff08e3.js"><link rel="prefetch" href="/assets/js/60.7bde9e3d.js"><link rel="prefetch" href="/assets/js/61.f3a7e6bb.js"><link rel="prefetch" href="/assets/js/62.09384c59.js"><link rel="prefetch" href="/assets/js/63.eb8467c1.js"><link rel="prefetch" href="/assets/js/64.03a24e27.js"><link rel="prefetch" href="/assets/js/65.aa53b344.js"><link rel="prefetch" href="/assets/js/66.f86993a5.js"><link rel="prefetch" href="/assets/js/67.61892c01.js"><link rel="prefetch" href="/assets/js/68.23868e81.js"><link rel="prefetch" href="/assets/js/69.72aafe65.js"><link rel="prefetch" href="/assets/js/7.de9c1511.js"><link rel="prefetch" href="/assets/js/70.9528684e.js"><link rel="prefetch" href="/assets/js/71.36ce469a.js"><link rel="prefetch" href="/assets/js/72.2a182164.js"><link rel="prefetch" href="/assets/js/73.3ebed1b8.js"><link rel="prefetch" href="/assets/js/74.69a729cf.js"><link rel="prefetch" href="/assets/js/75.8bebdd76.js"><link rel="prefetch" href="/assets/js/76.58491d71.js"><link rel="prefetch" href="/assets/js/78.a50244c5.js"><link rel="prefetch" href="/assets/js/79.39965a2e.js"><link rel="prefetch" href="/assets/js/80.73100ad3.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.857e8e87.js">
    <link rel="stylesheet" href="/assets/css/0.styles.637df5cf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/planqk.png" alt="PlanQK Docs" class="logo"> <span class="site-name can-hide">PlanQK Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Documentation
</a></div><div class="nav-item"><a href="/tutorials/" class="nav-link router-link-active">
  Tutorials &amp; Cookbooks
</a></div><div class="nav-item"><a href="https://www.planqk.de" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PlanQK Platform
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.planqk.de/pricing" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Pricing
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://join.slack.com/t/planqk-platform/shared_invite/zt-1b4899wqr-xqOYLSCr8KqYkREi251NxQ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Slack
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Documentation
</a></div><div class="nav-item"><a href="/tutorials/" class="nav-link router-link-active">
  Tutorials &amp; Cookbooks
</a></div><div class="nav-item"><a href="https://www.planqk.de" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PlanQK Platform
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.planqk.de/pricing" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Pricing
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://join.slack.com/t/planqk-platform/shared_invite/zt-1b4899wqr-xqOYLSCr8KqYkREi251NxQ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Slack
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tutorials</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tutorials/tutorial-dwave.html" class="sidebar-link">D-Wave Service on PlanQK</a></li><li><a href="/tutorials/tutorial-qiskit.html" class="sidebar-link">Execute Qiskit Circuits using the PlanQK Quantum SDK</a></li><li><a href="/tutorials/tutorial-meter-external-service.html" aria-current="page" class="active sidebar-link">Create and Test an On-premise Service</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tutorials/tutorial-meter-external-service.html#the-example-service" class="sidebar-link">The Example Service</a></li><li class="sidebar-sub-header"><a href="/tutorials/tutorial-meter-external-service.html#host-the-example-service" class="sidebar-link">Host the Example Service</a></li><li class="sidebar-sub-header"><a href="/tutorials/tutorial-meter-external-service.html#integrate-as-an-on-premise-service-on-the-planqk-platform" class="sidebar-link">Integrate as an On-premise Service on the PlanQK Platform</a></li><li class="sidebar-sub-header"><a href="/tutorials/tutorial-meter-external-service.html#add-a-pricing-plan" class="sidebar-link">Add a Pricing Plan</a></li><li class="sidebar-sub-header"><a href="/tutorials/tutorial-meter-external-service.html#create-an-access-token" class="sidebar-link">Create an Access Token</a></li><li class="sidebar-sub-header"><a href="/tutorials/tutorial-meter-external-service.html#test-your-service" class="sidebar-link">Test your Service</a></li></ul></li><li><a href="/tutorials/tutorial-local-testing-with-cli-and-service-sdk.html" class="sidebar-link">Utilize the PlanQK Service SDK for Local Development</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Cookbooks</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tutorials/cookbook-java.html" class="sidebar-link">Automate PlanQK using Java</a></li><li><a href="/tutorials/cookbook-python.html" class="sidebar-link">Automate PlanQK using Python</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="create-and-test-an-on-premise-service"><a href="#create-and-test-an-on-premise-service" class="header-anchor">#</a> Create and Test an On-premise Service</h1> <p>In this tutorial you will learn how to create an on-premise service with a pay-per-use pricing plan
and report the usage of your service to our metering API.
Further reading on external services can be found in our <a href="/on-premise-services/introduction.html">On-premise Services documentation</a>.</p> <h2 id="the-example-service"><a href="#the-example-service" class="header-anchor">#</a> The Example Service</h2> <p>As our example we use a simple FastAPI service that reports for each request an API call to the metering API.
You can find the complete code of the service in <a href="https://github.com/PlanQK/planqk-platform-samples/tree/master/planqk-services/external-service-sample" target="_blank" rel="noopener noreferrer">this GitHub repo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
An excerpt of the service with the metering code is shown below:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">meter_api_usage</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span> Union<span class="token punctuation">[</span>Request<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    correlation_id <span class="token operator">=</span> request<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;x-correlation-id&quot;</span><span class="token punctuation">)</span>
    PLANQK_METERING_API <span class="token operator">=</span> <span class="token string">&quot;https://platform.planqk.de/qc-catalog/external-services/metering&quot;</span>
    ACCESS_TOKEN <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">&quot;ACCESS_TOKEN&quot;</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
    PRODUCT_ID <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">&quot;PRODUCT_ID&quot;</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>

    payload <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;correlationId&quot;</span><span class="token punctuation">:</span> correlation_id<span class="token punctuation">,</span>
        <span class="token string">&quot;productId&quot;</span><span class="token punctuation">:</span> PRODUCT_ID<span class="token punctuation">,</span>
        <span class="token string">&quot;count&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>METERING_API_URL<span class="token punctuation">,</span> json<span class="token operator">=</span>payload<span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;X-Auth-Token&quot;</span><span class="token punctuation">:</span> ACCESS_TOKEN<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>The <code>meter_api_usage</code> method sends a POST request to the metering API with the following request body:</p> <ul><li>The <code>correlationId</code> is needed identify the consumer of your.
The correlation id is obtained from the <code>x-correlation-id</code> header of the request that was forwarded by the PlanQK API Gateway to your service.</li> <li>The <code>productId</code> holds the id of the API product you want to report. We will learn how to obtain the id in the next step.</li> <li>The <code>count</code> is the quantity of units you want to report in this case we report 1 API call.</li></ul> <p>For authentication, an access token is provided in the <code>X-Auth-Token</code> header field.</p> <p>You must provide the API product id and access token as environment variables to your service.
In the following steps, you will learn how to obtain both the API product ID and access token.</p> <h2 id="host-the-example-service"><a href="#host-the-example-service" class="header-anchor">#</a> Host the Example Service</h2> <p>First you need to deploy the service on an infrastructure of your choice.
An easy and free solution is <a href="https://render.com/" target="_blank" rel="noopener noreferrer">Render<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>You can deploy this example to render with just a couple of clicks:</p> <ul><li>Go to <a href="https://dashboard.render.com/select-repo?type=web" target="_blank" rel="noopener noreferrer">Render<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Create new &quot;Web Service&quot; from &quot;Public Git repository&quot;
<ul><li>Use <code>https://github.com/PlanQK/planqk-platform-samples</code> as public repository URL</li> <li>Choose a region close to you</li> <li>Use <code>master</code> as branch</li> <li>Use <code>python/external-service-sample</code> as root directory</li> <li>Use <code>Docker</code> as runtime</li> <li>Choose an instance type, i.e., the &quot;Free&quot; plan is just fine</li> <li>Click &quot;Create Web Service&quot;</li> <li>And your done your service should be up and running in a few minutes  🎉</li></ul></li></ul> <h2 id="integrate-as-an-on-premise-service-on-the-planqk-platform"><a href="#integrate-as-an-on-premise-service-on-the-planqk-platform" class="header-anchor">#</a> Integrate as an On-premise Service on the PlanQK Platform</h2> <p>Once your service is deployed, you can integrate it as an on-premise service on the PlanQK Platform.
To do so, follow these steps:</p> <ol><li>Go to the <a href="https://platform.planqk.de/services/new" target="_blank" rel="noopener noreferrer">create service page<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>Enter a name for your service.</li> <li>Under <code>Service Type</code> select <code>On-premise Service</code>.</li> <li>Enter the URL of your service.</li> <li>Add the <a href="https://raw.githubusercontent.com/PlanQK/planqk-platform-samples/master/planqk-services/external-service-sample/api-spec.yaml" target="_blank" rel="noopener noreferrer">API specification<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for your service.</li> <li>Finally, click on <code>Create Service</code>.</li></ol> <h2 id="add-a-pricing-plan"><a href="#add-a-pricing-plan" class="header-anchor">#</a> Add a Pricing Plan</h2> <p>Next, create a pay-per-use pricing plan for your service containing a product for API calls.
You can create a pricing plan for your service by following these steps:</p> <ol><li>On the details page of your service, click on <code>Create Pricing Plan</code>.</li> <li>On the create pricing plan page, add a product to the pricing plan and enter the following values:
<ul><li><strong>Name</strong>: <code>API</code></li> <li><strong>Unit Price</strong>: <code>0.00001</code>, or any other price you want to charge for an API call</li> <li><strong>Unit</strong>: <code>call</code></li></ul></li> <li>Click on <code>Create Plan</code>.</li> <li>On the services details page you will see your pricing plan with the product <code>API</code>.</li> <li>Copy the ID of your API product by clicking on the copy icon.</li> <li>Add the ID as environment variable with key <code>PRODUCT_ID</code> to your service.</li></ol> <h2 id="create-an-access-token"><a href="#create-an-access-token" class="header-anchor">#</a> Create an Access Token</h2> <p>Requests to the metering API must be authenticated with an access token.
You can create an access token on the <a href="https://platform.planqk.de/settings/access-tokens" target="_blank" rel="noopener noreferrer">Personal Access Tokens<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> page of your account.
The access token must have the <code>API</code> scope.</p> <p>Once you have created the access token, you can add it as environment variable with key <code>ACCESS_TOKEN</code>to your service.</p> <h2 id="test-your-service"><a href="#test-your-service" class="header-anchor">#</a> Test your Service</h2> <p>Once you have added the API product ID and access token to your service, its time to test if everything works.
You can test your service using our Metering Test Mode by following these steps:</p> <ol><li>Publish your service internal by clicking on <code>Publish Internal</code> on the service details page.</li> <li>Create an Application on the <a href="https://platform.planqk.de/applications" target="_blank" rel="noopener noreferrer">Applications<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> page.</li> <li>Subscribe to your service by clicking on <code>Subscribe to Service</code> on the application details page.
Now, you should see your service on the subscription list of the application</li> <li>Click on the <code>Try it out</code> button of your subscription.</li> <li>On the <code>Try it out</code> page, send a POST request to your service.</li> <li>On the details page of your service, click on the <code>Metering Events</code> to show the test metering history of your service.
There you should see the API call you just sent.</li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/PlanQK/planqk-platform-docs/edit/main/src/tutorials/tutorial-meter-external-service.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tutorials/tutorial-qiskit.html" class="prev">
        Execute Qiskit Circuits using the PlanQK Quantum SDK
      </a></span> <span class="next"><a href="/tutorials/tutorial-local-testing-with-cli-and-service-sdk.html">
        Utilize the PlanQK Service SDK for Local Development
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><VueCustomTooltip></VueCustomTooltip><!----></div></div>
    <script src="/assets/js/app.05958cb9.js" defer></script><script src="/assets/js/2.acda9268.js" defer></script><script src="/assets/js/1.cf86e968.js" defer></script><script src="/assets/js/77.a9350b63.js" defer></script>
  </body>
</html>
